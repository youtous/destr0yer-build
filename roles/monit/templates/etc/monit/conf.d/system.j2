
# System load checking
check system {{ hostname }}
    if loadavg (5min) > {{ ansible_processor_cores * 1.5 }} for 5 cycles then alert
    if loadavg (15min) > {{ ansible_processor_cores }} for 5 cycles then alert
    if memory usage > {{ monit_memory_usage_alert }} for 5 cycles then alert
    if swap usage > {{ monit_swap_usage_alert }} for 5 cycles then alert
    if cpu usage (user) > {{ monit_cpu_user_usage_alert }} for 5 cycles then alert
    if cpu usage (system) > {{ monit_cpu_system_usage_alert }} for 5 cycles then alert
    if cpu usage (wait) > {{ monit_cpu_wait_usage_alert }} for 5 cycles then alert


# Filesystems
{% for fs in monit_all_filesystems %}
{% if fs.mnt in mounted_devices_path %}
check filesystem {{ fs.mnt|replace('/','') }}fs with path {{ fs.mnt }}
    if space usage > {{ fs.usage_alert }} then alert
{% endif %}
{% endfor %}

