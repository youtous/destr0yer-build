---
# Setup a strategy of retention of the backups.
# Each day, the backup directory will be copied in a given directory.
- name: Install cron
  ansible.builtin.apt:
    pkg: cron
    state: present

- name: Enable cron
  ansible.builtin.service:
    name: cron
    state: started
    enabled: true

- name: Ensure frozen backup directory present and owned by root
  become: true
  ansible.builtin.file:
    state: directory
    path: "{{ backup_frozen_directory }}"
    owner: root
    group: root
    mode: u=rwx,g=,o=

- name: Setup frozen backup job
  become: true
  ansible.builtin.cron:
    name: "frozen-backup"
    minute: "{{ backup_frozen_cron.minute }}"
    hour: "{{ backup_frozen_cron.hour }}"
    job: "rsync -avu --delete \"{{ backup_root_directory }}/\" \"{{ backup_frozen_directory }}\" > /dev/null"

...
