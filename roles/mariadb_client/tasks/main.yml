---
# This role installs Mariadb-client on the system. It allows connections to database_servers hosts using ssl.

- name: Install mariadb-client
  become: true
  ansible.builtin.apt:
    name:
      - mariadb-client

- name: Ensure mariadb extra conf directory exists
  become: true
  ansible.builtin.file:
    state: directory
    path: "{{ mariadb_config_include_dir }}"
    owner: root
    group: root
    mode: u=rwx,g=rx,o=rx

- name: Copy client conf mariadb
  become: true
  ansible.builtin.template:
    src: "templates/50-ssl-clients.cnf.j2"
    dest: "{{ mariadb_config_include_dir }}/50-ssl-clients.cnf"
    owner: root
    group: root
    mode: u=rw,g=r,o=r

- name: Configure SSL on mariadb
  ansible.builtin.import_tasks: ssl.yml
  when: mariadb_ssl_enabled
...
