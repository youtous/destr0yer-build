---

# see https://github.com/unxnn/ansible-users

- name: Add password to root user
  become: true
  user:
    name: root
    password: "{{ root_password }}"

- name: Setup users
  become: true
  import_role:
    name: unxnn.users

- name: Allow admin group sudo with password
  become: true
  lineinfile:
    path: /etc/sudoers
    state: present
    regexp: '^%admin ALL='
    line: '%admin ALL=(ALL) PASSWD: ALL'
    validate: '/usr/sbin/visudo -cf %s'
  tags: ["users", "groups", "configuration"]