{"_index":".opendistro-alerting-config","_type":"_doc","_id":"90MbGHUBoabqJtNt42nH","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Heartbeat downtime detector","enabled":true,"enabled_time":1602427282316,"schedule":{"period":{"interval":1,"unit":"MINUTES"}},"inputs":[{"search":{"indices":["heartbeat-*"],"query":{"size":0,"query":{"bool":{"must":[{"term":{"monitor.status":{"value":"down","boost":1}}}],"filter":[{"range":{"@timestamp":{"from":"now-2m","to":null,"include_lower":true,"include_upper":true,"boost":1}}}],"adjust_pure_negative":true,"boost":1}},"aggregations":{"by_monitors":{"terms":{"field":"monitor.name","size":10,"min_doc_count":1,"shard_min_doc_count":0,"show_term_doc_count_error":false,"order":[{"_count":"desc"},{"_key":"asc"}]}}}}}}],"triggers":[{"id":"J0VIGHUBoabqJtNt0fOn","name":"Service(s) not available detected","severity":"4","condition":{"script":{"source":"ctx.results[0].hits.total.value > 1","lang":"painless"}},"actions":[{"id":"KEVIGHUBoabqJtNt0fOn","name":"Service down detector","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElastAlert] {{ctx.monitor.name}} >>> (failed {{ ctx.results.0.hits.total.value }} times) {{ctx.trigger.name}} <<<'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n\nServices:\n{{#ctx.results.0.aggregations.by_monitors.buckets}}\n  >>> [FAILED {{ doc_count }} times] - {{key}}\n{{/ctx.results.0.aggregations.by_monitors.buckets}}\n\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":true,"subject_template":{"source":"","lang":"mustache"},"throttle":{"value":10,"unit":"MINUTES"}}]}],"last_update_time":1602431124571,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"MINUTES","interval":1},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"query","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"},"triggers":{"Service(s) not available detected":{"value":10000,"enum":"ABOVE"}}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"6BrtB3UBQ_9QbmhdAH_S","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Anomaly 5xx codes","enabled":true,"enabled_time":1602155774043,"schedule":{"period":{"interval":20,"unit":"MINUTES"}},"inputs":[{"search":{"indices":[".opendistro-anomaly-results*"],"query":{"size":1,"query":{"bool":{"filter":[{"range":{"data_end_time":{"from":"{{period_end}}||-20m","to":"{{period_end}}","include_lower":true,"include_upper":true,"boost":1}}},{"term":{"detector_id":{"value":"GxroB3UBQ_9Qbmhdw0Ce","boost":1}}}],"adjust_pure_negative":true,"boost":1}},"sort":[{"anomaly_grade":{"order":"desc"}},{"confidence":{"order":"desc"}}],"aggregations":{"max_anomaly_grade":{"max":{"field":"anomaly_grade"}}}}}}],"triggers":[{"id":"XxrvB3UBQ_9Qbmhd7KkY","name":"Too many 5xx errors","severity":"1","condition":{"script":{"source":"return ctx.results[0].aggregations.max_anomaly_grade.value != null && ctx.results[0].aggregations.max_anomaly_grade.value > 0.9 && ctx.results[0].hits.hits[0]._source.confidence > 0.9","lang":"painless"}},"actions":[{"id":"YBrvB3UBQ_9Qbmhd7KkY","name":"Traefik too many 5xx responses","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElasticAlert] {{ctx.trigger.name}}'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":true,"subject_template":{"source":"","lang":"mustache"},"throttle":{"value":10,"unit":"MINUTES"}}]}],"last_update_time":1602155965496,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"MINUTES","interval":20},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"ad","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"},"triggers":{"Too many 5xx errors":{"adTriggerMetadata":{"anomalyConfidence":{"value":0.9,"enum":"ABOVE"},"triggerType":"anomaly_detector_trigger","anomalyGrade":{"value":0.9,"enum":"ABOVE"}},"value":10000,"enum":"ABOVE"}}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"_khxGHUBoabqJtNts1QZ","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Monitor mailserver.svur.org mailserver container status","enabled":true,"enabled_time":1602432905995,"schedule":{"period":{"interval":5,"unit":"MINUTES"}},"inputs":[{"search":{"indices":["metricbeat-*-svur.org-*"],"query":{"from":0,"size":1,"query":{"bool":{"filter":[{"bool":{"must":[{"bool":{"must":[{"bool":{"must_not":[{"bool":{"must_not":[{"exists":{"field":"docker.container.status","boost":1}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},{"wildcard":{"container.name":{"wildcard":"mailserver?mailserver*","boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},{"range":{"@timestamp":{"from":"now-5m","to":"now","include_lower":true,"include_upper":true,"format":"strict_date_optional_time","boost":1}}}],"adjust_pure_negative":true,"boost":1}},"_source":{"includes":["docker.container.status"],"excludes":[]},"sort":[{"@timestamp":{"order":"desc"}}],"collapse":{"field":"docker.container.status"}}}}],"triggers":[{"id":"60umGHUBoabqJtNt8Wc1","name":"Mailserver container is NOT UP","severity":"4","condition":{"script":{"source":"\nif (ctx.results[0].hits.total.value > 0) {\n    boolean up = ctx.results[0].hits.hits[0].fields['docker.container.status'].0  ==~ /^Up.*$/;\n    return !up;\n} else {\n return true;\n}\n","lang":"painless"}},"actions":[{"id":"7EumGHUBoabqJtNt8Wc1","name":"Alert mailserver is down","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElastAlert] {{ctx.monitor.name}} >>> {{ctx.trigger.name}} <<<'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":false,"subject_template":{"source":"","lang":"mustache"}}]}],"last_update_time":1602439925082,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"MINUTES","interval":5},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"query","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"},"triggers":{"Mailserver container is NOT UP":{"value":10000,"enum":"ABOVE"}}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"gHHyDXUBQ_9QbmhdkZd_","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Monitor daily backup castle.youtous.me","enabled":true,"enabled_time":1602256802171,"schedule":{"period":{"interval":1,"unit":"DAYS"}},"inputs":[{"search":{"indices":["journalbeat-*-castle.youtous.me-*"],"query":{"size":0,"query":{"bool":{"filter":[{"bool":{"must":[{"bool":{"must":[{"term":{"host.name":{"value":"castle.youtous.me","boost":1}}},{"term":{"systemd.unit":{"value":"cron.service","boost":1}}},{"wildcard":{"message":{"wildcard":"*duply*","boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},{"range":{"@timestamp":{"from":"now-1d","to":"now","include_lower":true,"include_upper":true,"format":"strict_date_optional_time","boost":1}}}],"adjust_pure_negative":true,"boost":1}}}}}],"triggers":[{"id":"DoZoD3UBQ_9Qbmhd37bt","name":"No backup castle.youtous.me","severity":"3","condition":{"script":{"source":"ctx.results[0].hits.total.value < 1","lang":"painless"}},"actions":[{"id":"D4ZoD3UBQ_9Qbmhd37bt","name":"Email no backup castle.youtous.me","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElastAlert] {{ctx.trigger.name}}'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":false,"subject_template":{"source":"","lang":"mustache"}}]}],"last_update_time":1602281679636,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"DAYS","interval":1},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"query","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"xEFUE3UBCP4BczWM-dPN","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Monitor metricbeats from castle.youtous.me","enabled":true,"enabled_time":1602347137445,"schedule":{"period":{"interval":30,"unit":"MINUTES"}},"inputs":[{"search":{"indices":["metricbeat-*-castle.youtous.me-*"],"query":{"size":0,"query":{"bool":{"filter":[{"bool":{"must":[{"bool":{"must":[{"term":{"host.name":{"value":"castle.youtous.me","boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},{"range":{"@timestamp":{"from":"now-30m","to":"now","include_lower":true,"include_upper":true,"format":"strict_date_optional_time","boost":1}}}],"adjust_pure_negative":true,"boost":1}}}}}],"triggers":[{"id":"l0JYE3UBCP4BczWM9Qz6","name":"No metrics from castle.youtous.me","severity":"2","condition":{"script":{"source":"ctx.results[0].hits.total.value < 1","lang":"painless"}},"actions":[{"id":"mEJYE3UBCP4BczWM9Qz6","name":"No metrics received","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElastAlert] {{ctx.monitor.name}} >>> {{ctx.trigger.name}} <<<'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":false,"subject_template":{"source":"","lang":"mustache"}}]}],"last_update_time":1602347398650,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"MINUTES","interval":30},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"query","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"},"triggers":{"No metrics from castle.youtous.me":{"value":10000,"enum":"ABOVE"}}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"tIdvD3UBQ_9QbmhdTBUB","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Monitor daily backup krug.svur.org","enabled":true,"enabled_time":1602281753599,"schedule":{"period":{"interval":1,"unit":"DAYS"}},"inputs":[{"search":{"indices":["journalbeat-*-svur.org-*"],"query":{"size":0,"query":{"bool":{"filter":[{"bool":{"must":[{"bool":{"must":[{"term":{"host.name":{"value":"krug.svur.org","boost":1}}},{"term":{"systemd.unit":{"value":"cron.service","boost":1}}},{"wildcard":{"message":{"wildcard":"*duply*","boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},{"range":{"@timestamp":{"from":"now-1d","to":"now","include_lower":true,"include_upper":true,"format":"strict_date_optional_time","boost":1}}}],"adjust_pure_negative":true,"boost":1}}}}}],"triggers":[{"id":"podwD3UBQ_9QbmhdiCcH","name":"No backup krug.svur.org","severity":"3","condition":{"script":{"source":"ctx.results[0].hits.total.value < 1","lang":"painless"}},"actions":[{"id":"p4dwD3UBQ_9QbmhdiCcH","name":"No backup krug.svur.org","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElastAlert] {{ctx.trigger.name}}'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":false,"subject_template":{"source":"","lang":"mustache"}}]}],"last_update_time":1602281834503,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"DAYS","interval":1},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"query","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"},"triggers":{"No backup krug.svur.org":{"value":10000,"enum":"ABOVE"}}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"1EJaE3UBCP4BczWMaSIm","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Monitor metricbeats from krug.svur.org","enabled":true,"enabled_time":1602347493664,"schedule":{"period":{"interval":30,"unit":"MINUTES"}},"inputs":[{"search":{"indices":["metricbeat-*-svur.org-*"],"query":{"size":0,"query":{"bool":{"filter":[{"bool":{"must":[{"bool":{"must":[{"term":{"host.name":{"value":"krug.svur.org","boost":1}}}],"adjust_pure_negative":true,"boost":1}}],"adjust_pure_negative":true,"boost":1}},{"range":{"@timestamp":{"from":"now-30m","to":"now","include_lower":true,"include_upper":true,"format":"strict_date_optional_time","boost":1}}}],"adjust_pure_negative":true,"boost":1}}}}}],"triggers":[{"id":"bkJbE3UBCP4BczWM1zjY","name":"No metrics from krug.svur.org","severity":"2","condition":{"script":{"source":"ctx.results[0].hits.total.value < 1","lang":"painless"}},"actions":[{"id":"b0JbE3UBCP4BczWM1zjY","name":"No metrics received","destination_id":"mrfD_nQBTx0AjIA5Y5lw","message_template":{"source":"to: ['monitoring@youtous.me']\nsubject: '[ElastAlert] {{ctx.monitor.name}} >>> {{ctx.trigger.name}} <<<'\n---\nMonitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue.\n- Trigger: {{ctx.trigger.name}}\n- Severity: {{ctx.trigger.severity}}\n- Period start: {{ctx.periodStart}}\n- Period end: {{ctx.periodEnd}}","lang":"mustache"},"throttle_enabled":false,"subject_template":{"source":"","lang":"mustache"}}]}],"last_update_time":1602347587544,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"MINUTES","interval":30},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"query","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"},"triggers":{"No metrics from krug.svur.org":{"value":10000,"enum":"ABOVE"}}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"TRwRCHUBQ_9QbmhdbYoY","_score":1,"_source":{"monitor":{"type":"monitor","schema_version":2,"name":"Anomaly 404 errors","enabled":true,"enabled_time":1602158161172,"schedule":{"period":{"interval":20,"unit":"MINUTES"}},"inputs":[{"search":{"indices":[".opendistro-anomaly-results*"],"query":{"size":1,"query":{"bool":{"filter":[{"range":{"data_end_time":{"from":"{{period_end}}||-20m","to":"{{period_end}}","include_lower":true,"include_upper":true,"boost":1}}},{"term":{"detector_id":{"value":"0RjQB3UBQ_9QbmhdmeBH","boost":1}}}],"adjust_pure_negative":true,"boost":1}},"sort":[{"anomaly_grade":{"order":"desc"}},{"confidence":{"order":"desc"}}],"aggregations":{"max_anomaly_grade":{"max":{"field":"anomaly_grade"}}}}}}],"triggers":[],"last_update_time":1602158161173,"ui_metadata":{"schedule":{"cronExpression":"0 */1 * * *","period":{"unit":"MINUTES","interval":20},"timezone":null,"daily":0,"monthly":{"type":"day","day":1},"weekly":{"tue":false,"wed":false,"thur":false,"sat":false,"fri":false,"mon":false,"sun":false},"frequency":"interval"},"search":{"aggregationType":"count","fieldName":"","overDocuments":"all documents","searchType":"ad","bucketValue":1,"timeField":"","groupedOverTop":5,"bucketUnitOfTime":"h","where":{"fieldName":[],"fieldRangeEnd":0,"fieldRangeStart":0,"fieldValue":"","operator":"is"},"groupedOverFieldName":"bytes"}}}}}
{"_index":".opendistro-alerting-config","_type":"_doc","_id":"mrfD_nQBTx0AjIA5Y5lw","_score":1,"_source":{"destination":{"type":"custom_webhook","name":"smtp","schema_version":2,"last_update_time":1602002051344,"custom_webhook":{"path":null,"header_params":{},"password":null,"scheme":null,"port":-1,"query_params":{},"host":null,"url":"http://alerts-smtp-forwarder:8080/email","username":null}}}}
