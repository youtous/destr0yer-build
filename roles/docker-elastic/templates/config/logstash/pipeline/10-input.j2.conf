input {
  tcp {
    port => 5000
    tags => ["internal_input"]
    type => syslog
    ssl_enable => true
    ssl_certificate_authorities => ["/etc/ca.crt"]
    ssl_cert => "/etc/server.crt"
    ssl_key => "/etc/server.key"
    ssl_verify => true
  }
  beats {
    port => 5044
    tags => ["internal_input"]
    ssl => true
    ssl_certificate_authorities => ["/etc/ca.crt"]
    ssl_certificate => "/etc/server.crt"
    ssl_key => "/etc/server.key"
    ssl_verify_mode => force_peer
    tls_min_version => "1.2"
  }
  # for external usage ONLY, use it under a VPN
  beats {
    port => 5064
    tags => ["external_input"]
    ssl => true
    ssl_certificate_authorities => ["/etc/ca.crt"]
    ssl_certificate => "/etc/server.crt"
    ssl_key => "/etc/server.key"
    ssl_verify_mode => force_peer
    tls_min_version => "1.2"
  }
}