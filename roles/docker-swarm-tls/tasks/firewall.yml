---
# Firewall configuration
# Revocation rules
- name: Revoke nodes firewall - tcp/2376
  become: yes
  ufw:
    rule: allow
    port: "2376"
    src: "{{ item }}"
    delete: yes
  with_items: "{{ revoked_nodes_ips }}"

- name: Revoke nodes firewall - tcp/2377
  become: yes
  ufw:
    rule: allow
    port: "2377"
    src: "{{ item }}"
    delete: yes
  with_items: "{{ revoked_nodes_ips }}"

- name: Revoke nodes firewall - tcp,udp/7946
  become: yes
  ufw:
    rule: allow
    port: "7946"
    src: "{{ item }}"
    delete: yes
  with_items: "{{ revoked_nodes_ips }}"

- name: Revoke nodes firewall - tcp,udp/4789
  become: yes
  ufw:
    rule: allow
    port: "4789"
    src: "{{ item }}"
    delete: yes
  with_items: "{{ revoked_nodes_ips }}"

- name: Allow nodes ips to pass firewall - tcp/2376
  become: yes
  ufw:
    rule: allow
    port: "2376"
    src: "{{ item }}"
  with_items: "{{ nodes_ips }}"

- name: Allow nodes ips to pass firewall - tcp/2377
  become: yes
  ufw:
    rule: allow
    port: "2377"
    src: "{{ item }}"
  with_items: "{{ nodes_ips }}"

- name: Allow nodes ips to pass firewall - tcp,udp/7946
  become: yes
  ufw:
    rule: allow
    port: "7946"
    src: "{{ item }}"
  with_items: "{{ nodes_ips }}"

- name: Allow nodes ips to pass firewall - tcp,udp/4789
  become: yes
  ufw:
    rule: allow
    port: "4789"
    src: "{{ item }}"
  with_items: "{{ nodes_ips }}"
...