---
database_clients_ips:
  "{{ (groups['database_clients'] | map('extract', hostvars, ['mariadb_client_ipv4']) | list | flatten | unique | default([]) +
       groups['database_clients'] | map('extract', hostvars, ['mariadb_client_ipv6']) | list | flatten | unique | default([])) | flatten }}"

# define database_clients allowed to access database servers, filter current host
mariadb_allowed_ips:
  "{{ ((database_clients_ips + local_docker_ips) | difference((mariadb_client_ipv4 | default([])
        + mariadb_client_ipv6 | default([])))) | flatten }}" # noqa var-naming # TODO : check if docker group is needed
...
